layer: 'application'
stack: 'backend'
language: 'go'

tags:
  - 'application'
  - 'backend'
  - 'go'
  - 'golang'
  - 'api'
  - 'rest'
  - 'http'

project:
  name: 'Go API'
  description: 'A Go Lang API'

tasks:
  install:
    command: 'go mod tidy'
    # inputs:
    #   - 'go.mod'``
    #   - 'go.sum'
    # outputs:
    #   - 'go.mod'
    #   - 'go.sum'

  build:
    command: 'go build -o bin/api-golang ./cmd/api'
    inputs:
      - '**/*.go'
      - 'go.mod'
      - 'go.sum'
    outputs:
      - 'bin/api-golang'
  
  dev:
    command: 'go run ./cmd/api/main.go'
    options:
      persistent: true
      cache: false
    inputs:
      - '**/*.go'
      - 'go.mod'
      - 'go.sum'

  start:
    command: 'go run ./cmd/api/main.go'
    inputs:
      - '**/*.go'
      - 'go.mod'
      - 'go.sum'

  test:
    command: 'go test -v ./...'
    inputs:
      - '**/*.go'
      - 'go.mod'
      - 'go.sum'

  test-coverage:
    command: 'go test -v -coverprofile=coverage.out -covermode=atomic ./...'
    inputs:
      - '**/*.go'
      - 'go.mod'
      - 'go.sum'
    outputs:
      - 'coverage.out'

  test-watch:
    command: 'go test -v ./...'
    options:
      persistent: true
    inputs:
      - '**/*.go'
      - 'go.mod'
      - 'go.sum'

  lint:
    command: 'go vet ./...'
    inputs:
      - '**/*.go'
      - 'go.mod'
      - 'go.sum'

  format:
    command: 'go fmt ./...'
    inputs:
      - '**/*.go'

  tidy:
    command: 'go mod tidy'
    inputs:
      - 'go.mod'
      - 'go.sum'

  clean:
    script: 'go clean -cache -testcache -modcache && rm -rf bin'
